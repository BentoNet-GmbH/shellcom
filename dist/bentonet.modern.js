class e{constructor(e,t=["bentonet.de",location.host]){this.allowedOrigins=[],this.searchHandlers=[],this.startupObservers=[],this.observers=[],window.bentonet=this,e&&window.bentonet.startupObservers.push(e),t&&(window.bentonet.allowedOrigins=t),window.bentonet.init()}init(){console.log("BentoNet: Init connection to platform..."),window.parent.postMessage({message:"APP.STARTUP"},"*"),window.addEventListener("beforeunload",function(){console.log("BentoNet: Shutdown connection to platform..."),window.parent.postMessage({message:"APP.SHUTDOWN"},"*")}),window.addEventListener("message",function(e){if(window.bentonet.checkAllowedOrigins(e.origin))switch(e.data.message){case"BENTONET.STARTUP":console.log("BentoNet: Connection successful..."),window.sessionStorage.setItem(e.data.key,e.data.value),window.bentonet.startupObservers.forEach(t=>{t(e.data.key,e.data.value)});break;case"BENTONET.SET":window.sessionStorage.setItem(e.data.key,e.data.value),window.bentonet.observers.forEach(t=>{t(e.data.key,e.data.value)});break;case"BENTONET.GET":let t=window.parent,n=window.sessionStorage.getItem(e.data.key);t.postMessage({message:"APP.RESPONSE",key:e.data.key,value:n},"*");break;case"BENTONET.REMOVE":window.sessionStorage.removeItem(e.data.key);break;case"SEARCH.START":window.bentonet.searchHandlers.forEach(t=>{t(e.data.value)})}else console.log("BentoNet: "+e.origin+" is not an allowed domain for messaging.")})}checkAllowedOrigins(e){let t=!1;return window.bentonet.allowedOrigins.forEach(n=>{console.log(e+" ==> "+n),e.toLowerCase().endsWith(n.toLowerCase())&&(t=!0)}),t}showSearchField(e){window.parent.postMessage({message:!0===e?"SEARCH.ENABLE":"SEARCH.DISABLE"},"*")}autoEnableSearchField(){window.bentonet.searchHandlers.length>0?window.bentonet.showSearchField(!0):window.bentonet.showSearchField(!1)}addSearchHandler(e){e&&window.bentonet.searchHandlers.push(e),window.bentonet.autoEnableSearchField()}removeSearchHandler(e){window.bentonet.searchHandlers.forEach((t,n)=>{t===e&&(window.bentonet.searchHandlers.splice(n,1),window.bentonet.autoEnableSearchField())})}addObserver(e){e&&window.bentonet.observers.push(e)}removeObserver(e){window.bentonet.observers.forEach((t,n)=>{t===e&&window.bentonet.observers.splice(n,1)})}showInfo(e,t){window.parent.postMessage({message:"APP.INFO",key:"content",value:{title:e,text:t}},"*")}showWarning(e,t){window.parent.postMessage({message:"APP.WARNING",key:"content",value:{title:e,text:t}},"*")}showError(e,t){window.parent.postMessage({message:"APP.ERROR",key:"content",value:{title:e,text:t}},"*")}showSuccess(e,t){parent.postMessage({message:"APP.SUCCESS",key:"content",value:{title:e,text:t}},"*")}}export{e as BentoNet};
//# sourceMappingURL=bentonet.modern.js.map
