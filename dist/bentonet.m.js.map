{"version":3,"file":"bentonet.m.js","sources":["../src/bentonet.js"],"sourcesContent":["\nclass BentoNet {\n\n    allowedOrigins = [];\n    searchHandlers = [];\n    startupObservers = [];\n    observers = [];\n\n    constructor(startupObserver, allowedOrigins = [\"bentonet.de\", location.host]) {\n        window.bentonet = this;\n        if (startupObserver) {\n            window.bentonet.startupObservers.push(startupObserver);\n        }\n        if(allowedOrigins) {\n            window.bentonet.allowedOrigins = allowedOrigins;\n        }\n        window.bentonet.init();\n    }\n\n    init() {\n        console.log(\"BentoNet: Init connection to platform...\");\n        let parent = window.parent;\n        parent.postMessage({ message: \"APP.STARTUP\" }, \"*\")\n\n        window.addEventListener( \"beforeunload\", function() {\n            console.log(\"BentoNet: Shutdown connection to platform...\");\n            var parent = window.parent;\n            parent.postMessage({ message: \"APP.SHUTDOWN\" }, \"*\")\n        });\n\n        window.addEventListener(\"message\", function(event) {\n            if(!window.bentonet.checkAllowedOrigins(event.origin)) {\n                console.log(\"BentoNet: \" + event.origin + \" is not an allowed domain for messaging.\");\n                return;\n            }\n            switch (event.data.message) {\n                case 'BENTONET.STARTUP':\n                    window.sessionStorage.setItem(event.data.key, event.data.value);\n                    window.bentonet.startupObservers.forEach( handler => {\n                        handler(event.data.key, event.data.value);\n                    })\n                    break;\n                case 'BENTONET.SET':\n                    window.sessionStorage.setItem(event.data.key, event.data.value);\n                    window.bentonet.observers.forEach( handler => {\n                        handler(event.data.key, event.data.value);\n                    })\n                    break;\n                case 'BENTONET.GET':\n                    let parent = window.parent;\n                    let data = window.sessionStorage.getItem(event.data.key);\n                    let returnPayload = {\n                        message: 'APP.RESPONSE',\n                        key: event.data.key,\n                        value: data\n                    }\n                    parent.postMessage(returnPayload, '*');\n                    break;\n                case 'BENTONET.REMOVE':\n                    window.sessionStorage.removeItem(event.data.key);\n                    break;\n                case 'SEARCH.START':\n                    window.bentonet.searchHandlers.forEach( handler => {\n                        handler(event.data.value);\n                    })\n            }\n        });\n    }\n\n    checkAllowedOrigins(origin) {\n        let allowed = false;\n        window.bentonet.allowedOrigins.forEach( allowedOrigin => {\n            console.log(origin + \" ==> \" + allowedOrigin);\n            if (origin.toLowerCase().endsWith(allowedOrigin.toLowerCase())) {\n                allowed = true;\n            }\n        })\n        return allowed;\n    }\n\n    showSearchField(show) {\n        let parent = window.parent;\n        let message = show === true ? \"SEARCH.ENABLE\" : \"SEARCH.DISABLE\";\n        parent.postMessage({ message: message }, \"*\")\n    }\n\n    autoEnableSearchField() {\n        if(window.bentonet.searchHandlers.length > 0) {\n            window.bentonet.showSearchField(true )\n        } else {\n            window.bentonet.showSearchField( false )\n        }\n    }\n\n    addSearchHandler(handler) {\n        if (handler) {\n            window.bentonet.searchHandlers.push(handler);\n        }\n        window.bentonet.autoEnableSearchField();\n    }\n\n    removeSearchHandler(handler) {\n        window.bentonet.searchHandlers.forEach( (h, i) => {\n            if(h === handler) {\n                window.bentonet.searchHandlers.splice(i, 1);\n                window.bentonet.autoEnableSearchField();\n            }\n        })\n    }\n\n    addObserver(handler) {\n        if (handler) {\n            window.bentonet.observers.push(handler);\n        }\n    }\n\n    removeObserver(handler) {\n        window.bentonet.observers.forEach( (h, i) => {\n            if(h === handler) {\n                window.bentonet.observers.splice(i, 1);\n            }\n        })\n    }\n\n    showInfo(title, info) {\n        let parent = window.parent;\n        parent.postMessage({ message: \"APP.INFO\", key: \"content\", value: { title: title, text: info}  }, \"*\")\n    }\n\n    showWarning(title, warning) {\n        let parent = window.parent;\n        parent.postMessage({ message: \"APP.WARNING\", key: \"content\", value: { title: title, text: warning}  }, \"*\")\n    }\n\n    showError(title, error) {\n        let parent = window.parent;\n        parent.postMessage({ message: \"APP.ERROR\", key: \"content\", value: { title: title, text: error}  }, \"*\")\n    }\n\n    showSuccess(title, message) {\n        parent.postMessage({ message: \"APP.SUCCESS\", key: \"content\", value: { title: title, text: message}  }, \"*\")\n    }\n}\n\nexport { BentoNet };"],"names":["BentoNet","startupObserver","allowedOrigins","location","host","searchHandlers","startupObservers","observers","window","bentonet","this","push","init","console","log","parent","postMessage","message","addEventListener","event","checkAllowedOrigins","origin","data","sessionStorage","setItem","key","value","forEach","handler","getItem","removeItem","allowed","allowedOrigin","toLowerCase","endsWith","showSearchField","show","autoEnableSearchField","length","addSearchHandler","removeSearchHandler","h","i","splice","addObserver","removeObserver","showInfo","title","info","text","showWarning","warning","showError","error","showSuccess"],"mappings":"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"}